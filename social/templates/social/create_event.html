{% extends 'landing/base.html' %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-lg border-0 rounded-lg">

        <!-- Header Section -->
        <div class="card-header bg-0f161b text-white py-4">
          <div class="d-flex align-items-center justify-content-between">
            <h2 class="mb-0">Create New Event</h2>
            <i class="fas fa-calendar-plus fa-2x"></i>
          </div>
          <p class="mb-0 mt-2 opacity-75">Fill in the details below to create your event</p>
          <p class="mb-0 mt-2 opacity-75"><strong class="text-red-600">*Note:</strong> * Creation of Event(s) that exceeds 5 days before its schedule is prohibited.
          <br>* Creation of Event(s) should be at least 3 days ahead otherwise it is prohibited </p>
        </div>

        <!-- Form Section -->
        <div class="card-body px-5 py-4 bg-white">
          <form method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
            {% csrf_token %}

            <!-- Show general form errors -->
            {% if form.non_field_errors %}
              <div class="alert alert-danger bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                {{ form.non_field_errors }}
              </div>
            {% endif %}

            <!-- Basic Information Section -->
            <div class="mb-5">
              <h4 class="mb-4 border-b border-gray-200 pb-2 text-0f161b"><i class="fas fa-info-circle me-2 text-red-600"></i>Basic Information</h4>

              <!-- Event Name -->
              <div class="mb-4">
                <label for="id_name" class="form-label font-bold text-0f161b">Event Name*</label>
                <input type="text" name="name" id="id_name" class="form-control form-control-lg border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Enter event name" required value="{{ form.name.value|default:'' }}">
                <div class="invalid-feedback text-red-600">Please provide an event name.</div>
              </div>

              <!-- Event Description -->
              <div class="mb-4">
                <label for="id_description" class="form-label font-bold text-0f161b">Event Description*</label>
                <textarea name="description" id="id_description" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" rows="4" placeholder="Describe your event in detail..." required>{{ form.description.value|default:'' }}</textarea>
                <div class="invalid-feedback text-red-600">Please provide an event description.</div>
                <small class="form-text text-gray-500">Tell attendees what to expect from your event.</small>
              </div>
            </div>

            <!-- Date & Location Section -->
            <div class="mb-5">
              <h4 class="mb-4 border-b border-gray-200 pb-2 text-0f161b"><i class="fas fa-map-marker-alt me-2 text-red-600"></i>When & Where</h4>

              <div class="row">
                <!-- Event Date -->
                <div class="col-md-6 mb-4">
                  <label for="id_date" class="form-label font-bold text-0f161b">Event Date & Time*</label>
                  <input type="datetime-local" name="date" id="id_date" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500 {% if form.date.errors %}border-red-500{% endif %}" required value="{{ form.date.value|default:'' }}">
                  {% if form.date.errors %}
                    <div class="invalid-feedback d-block text-red-600">
                      {{ form.date.errors.0 }}
                    </div>
                  {% else %}
                    <div class="invalid-feedback text-red-600">Please select a date and time.</div>
                  {% endif %}
                </div>

                <!-- Event Location Type -->
                <div class="col-md-6 mb-4">
                  <label for="id_location_type" class="form-label font-bold text-0f161b">Location Type*</label>
                  <select name="location_type" id="id_location_type" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500 {% if form.location_type.errors %}border-red-500{% endif %}" required>
                    <option value="inside" {% if form.location_type.value == 'inside' %}selected{% endif %}>Inside the University</option>
                    <option value="outside" {% if form.location_type.value == 'outside' %}selected{% endif %}>Outside the University</option>
                  </select>
                  {% if form.location_type.errors %}
                    <div class="invalid-feedback d-block text-red-600">
                      {{ form.location_type.errors.0 }}
                    </div>
                  {% else %}
                    <div class="invalid-feedback text-red-600">Please select a location type.</div>
                  {% endif %}
                </div>
              </div>

              <!-- Dynamic Location Fields -->
              <div id="inside-location-fields" class="location-fields" style="display: none;">
                <!-- Inside University Fields -->
                <div class="row">
                  <div class="col-md-4 mb-4">
                    <label for="id_department" class="form-label font-bold text-0f161b">Department</label>
                    <input type="text" name="department" id="id_department" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Department" value="{{ form.department.value|default:'' }}">
                  </div>
                  <div class="col-md-4 mb-4">
                    <label for="id_building" class="form-label font-bold text-0f161b">Building</label>
                    <input type="text" name="building" id="id_building" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Building" value="{{ form.building.value|default:'' }}">
                  </div>
                  <div class="col-md-4 mb-4">
                    <label for="id_room_number" class="form-label font-bold text-0f161b">Room Number</label>
                    <input type="text" name="room_number" id="id_room_number" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Room Number" value="{{ form.room_number.value|default:'' }}">
                  </div>
                </div>
              </div>

              <div id="outside-location-fields" class="location-fields" style="display: none;">
                <!-- Outside University Fields -->
                <div class="row">
                  <div class="col-md-3 mb-4">
                    <label for="id_province" class="form-label font-bold text-0f161b">Province</label>
                    <input type="text" name="province" id="id_province" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Province" value="{{ form.province.value|default:'' }}">
                  </div>
                  <div class="col-md-3 mb-4">
                    <label for="id_municipality" class="form-label font-bold text-0f161b">Municipality</label>
                    <input type="text" name="municipality" id="id_municipality" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Municipality" value="{{ form.municipality.value|default:'' }}">
                  </div>
                  <div class="col-md-3 mb-4">
                    <label for="id_barangay" class="form-label font-bold text-0f161b">Barangay</label>
                    <input type="text" name="barangay" id="id_barangay" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Barangay" value="{{ form.barangay.value|default:'' }}">
                  </div>
                  <div class="col-md-3 mb-4">
                    <label for="id_specific_location" class="form-label font-bold text-0f161b">Specific Location</label>
                    <input type="text" name="specific_location" id="id_specific_location" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Specific Location" value="{{ form.specific_location.value|default:'' }}">
                  </div>
                </div>
              </div>
                            <!-- Registration Link Section -->
<div class="mb-4">
  <label for="id_registration_link" class="form-label font-bold text-0f161b">Event Registration Link <i>(Optional)</i> </label>
  <input type="url" name="registration_link" id="id_registration_link" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" placeholder="Enter event registration link (e.g. Google Form)" value="{{ form.registration_link.value|default:'' }}">
  <div class="invalid-feedback text-red-600">Please provide a valid registration link.</div>
</div>

            </div>

            

            <!-- Media Section -->
            <div class="mb-5">
              <h4 class="mb-4 border-b border-gray-200 pb-2 text-0f161b"><i class="fas fa-images me-2 text-red-600"></i>Media & Files</h4>

              <!-- Event Images -->
              <div class="mb-4">
                <label for="id_images" class="form-label font-bold text-0f161b">Event Images</label>
                <div class="file-upload-wrapper">
                  <input type="file" name="images" id="id_images" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" multiple accept="image/*">
                  <small class="form-text text-gray-500">Upload high-quality images that represent your event (JPEG, PNG)</small>
                </div>
              </div>
              <!-- External Link -->

              <!-- Event Files -->
              <!-- <div class="mb-4">
                <label for="id_files" class="form-label font-bold text-0f161b">Event Files</label>
                <div class="file-upload-wrapper">
                  <input type="file" name="files" id="id_files" class="form-control border-gray-300 focus:border-red-500 focus:ring-red-500" multiple>
                  <small class="form-text text-gray-500">Upload any supporting documents (PDF, Word, etc.)</small>
                </div>
              </div> -->
            </div>

            <!-- Submit Section -->
            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
              <button type="reset" class="btn btn-outline-secondary me-md-2 px-4 border-gray-300 text-0f161b hover:bg-gray-50">
                <i class="fas fa-undo me-2"></i>Reset
              </button>
              <button type="submit" class="btn bg-red-600 hover:bg-red-700 text-white px-4">
                <i class="fas fa-calendar-check me-2"></i>Create Event
              </button>
            </div>
          </form>
        </div>

        <!-- Footer Note -->
        <div class="card-footer bg-gray-50 py-3">
          <p class="mb-0 text-gray-500 small"><span class="text-red-600">*</span> indicates required fields</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add some custom styling -->
<style>
  .card {
    overflow: hidden;
    transition: transform 0.3s ease;
  }

  .card:hover {
    transform: translateY(-5px);
  }

  .file-upload-wrapper {
    position: relative;
    padding: 1.5rem;
    border: 2px dashed #e5e7eb;
    border-radius: 0.375rem;
    background-color: #f9fafb;
    transition: all 0.3s ease;
  }

  .file-upload-wrapper:hover {
    border-color: #ef4444;
    background-color: #fef2f2;
  }

  .form-control-lg {
    padding: 0.75rem 1rem;
    font-size: 1.1rem;
  }
  
  /* Custom color classes */
  .bg-0f161b {
    background-color: #0f161b;
  }
  
  .text-0f161b {
    color: #0f161b;
  }
  
  .border-b {
    border-bottom-width: 1px;
  }
</style>

<!-- Add form validation script -->
<script>
  (function () {
    'use strict'
    var forms = document.querySelectorAll('.needs-validation')
    Array.prototype.slice.call(forms)
      .forEach(function (form) {
        form.addEventListener('submit', function (event) {
          if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
          }
          form.classList.add('was-validated')
        }, false)
      })
  })()

  // JavaScript for showing/hiding location fields based on location type
  document.getElementById('id_location_type').addEventListener('change', function () {
    const locationType = this.value;
    const insideFields = document.getElementById('inside-location-fields');
    const outsideFields = document.getElementById('outside-location-fields');
    
    if (locationType === 'inside') {
      insideFields.style.display = 'block';
      outsideFields.style.display = 'none';
    } else {
      insideFields.style.display = 'none';
      outsideFields.style.display = 'block';
    }
  });
  
  // Initialize location fields on page load
  document.addEventListener('DOMContentLoaded', function() {
    const locationType = document.getElementById('id_location_type').value;
    const insideFields = document.getElementById('inside-location-fields');
    const outsideFields = document.getElementById('outside-location-fields');
    
    if (locationType === 'inside') {
      insideFields.style.display = 'block';
    } else {
      outsideFields.style.display = 'block';
    }
  });
</script>
{% endblock %}