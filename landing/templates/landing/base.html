
<!DOCTYPE html>
<html lang="en">
  <head>
    {% load static %}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"/>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.3/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />
    
    
     <!-- page specific css -->
    {% block extra_css %}{% endblock extra_css %}

    <title>CampusConnect</title>
  </head>

  <style>
    html {
      font-size: 16px;
    }
    
    @media (max-width: 768px) {
      html {
        font-size: 14px;
      }
    }
    
    .container {
      padding: 2rem;
      font-size: 1rem;
    }
  </style>

  <body style="background-color: #0f161b">
    {% load hashtag_filters %}
    {% if '/social/private_chat' not in request.path and request.path != '/social/post/report/' and request.path != '/' and '/social/conversations' not in request.path and '/social/post/edit' not in request.path and '/social/post/delete' not in request.path and 'conversation-search' not in request.path and 'social/post' not in request.path and 'social/feedback' not in request.path and 'social/banned' not in request.path and 'social/account-setup' not in request.path %}
      {% include 'landing/navbar.html' %}
    {% endif %}

    {% if '/social/conversation-search' in request.path %}
      {% include 'landing/conversation_list_navbar.html' %}
    {% endif %}

    {% block content %}
    {% endblock content %}

      <!-- page specifi js -->
    {% block extra_js %}{% endblock extra_js %}

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/e88870e020.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="{% static 'CampusConnect/js/CreateGroudp.js' %}"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>



    <script>
      {% if request.user.is_authenticated %}
          const protocol = window.location.protocol === 'https:' ? 'wss' : 'ws';
          const userStatusSocket = new WebSocket(
              protocol + '://' + window.location.host + '/ws/user_status/'
          );
  
          userStatusSocket.onopen = function(e) {
              console.log('User Status WebSocket connected.');
          };
  
          userStatusSocket.onclose = function(e) {
              console.log('User Status WebSocket disconnected.');
          };
  
          // Listen for messages from the WebSocket (status updates)
          userStatusSocket.onmessage = function(e) {
              const data = JSON.parse(e.data);
              console.log('Received data:', data);
  
              // Ensure the data contains the user_id and status
              const userId = data.user_id;
              const status = data.status; // 'online' or 'offline'
  
              // Get the status dot element for the followed user
              const statusDot = document.getElementById('status-dot-' + userId);
              const statusText = document.getElementById('status-text-' + userId);
  
              // If status dot exists, update it
              if (statusDot) {
                  if (status === 'online') {
                      statusDot.classList.add('bg-green-500');
                      statusDot.classList.remove('bg-red-500');
                      if (statusText) {
                          statusText.textContent = 'Online';
                          statusText.classList.remove('text-red-500');
                          statusText.classList.add('text-green-500');
                      }
                  } else {
                      statusDot.classList.add('bg-red-500');
                      statusDot.classList.remove('bg-green-500');
                      if (statusText) {
                          statusText.textContent = 'Offline';
                          statusText.classList.remove('text-green-500');
                          statusText.classList.add('text-red-500');
                      }
                  }
              }
          };
      {% endif %}
  </script>
  
  
  </body>
</html>
